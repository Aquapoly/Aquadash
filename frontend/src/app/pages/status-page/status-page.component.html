<div class="grid grid-cols-1 lg:grid-cols-12 gap-5 p-5 max-w-[96rem] m-auto">
  <select
    [(ngModel)]="selectedThresholdsDisplay"
    (change)="updateThresholdDisplay()"
    class="col-span-12 select w-full max-w-xs selectDiv"
  >
    @for (choice of chartChoices; track choice) {
    <option [ngValue]="chartChoices.indexOf(choice)">{{ choice }}</option>
    }
  </select>
  @if (sensors.length == 0) {
  <div class="flex justify-center col-span-12">
    <span class="loading loading-infinity loading-lg text-success"></span>
  </div>
  } @for (sensor of sensors; track sensor.sensor_id) {
  <div class="stats shadow text-center col-span-12 lg:col-span-3 bg-base-200">
    <div class="stat">
      <div class="stat-title">{{ this.getSensorTitle(sensor) }}</div>
      <div>
        <div
          [class]="['text-' + this.getSensorValidity(sensor), 'stat-value']"
          [id]="['sensor' + sensor.sensor_id]"
        >
          {{ this.getLastMeasurement(sensor) }}
        </div>
        <div class="stat-desc flex justify-center items-center">
          @if (sensor.sensor_type === 'ph') {
          <span class="opacity-70 text-sm">pH</span>
          } @else {
          <select
            [(ngModel)]="sensor.sensor_unit"
            (change)="onUnitChange(sensor)"
            class="select select-bordered select-sm text-center bg-base-200 text-base-content border-base-300 rounded-lg focus:outline-none focus:ring-1 focus:ring-success/60 transition-all duration-150 hover:border-success/40"
          >
            @for (unit of getAvailableUnits(sensor); track unit) {
            <option [value]="unit">{{ unit }}</option>
            }
          </select>
          }
        </div>
      </div>
      <div>
        <div
          class="grid grid-cols-5"
          *ngIf="getConvertedThresholds(sensor) as t"
        >
          <div class="cols-span-1 text-warning">
            {{
              t.critLow
                | number : (sensor.sensor_type === "ec" ? "1.0-5" : "1.0-2")
            }}
          </div>
          <div class="cols-span-1 text-success">
            {{
              t.low | number : (sensor.sensor_type === "ec" ? "1.0-5" : "1.0-2")
            }}
          </div>
          <div class="cols-span-1"></div>
          <div class="cols-span-1 text-success">
            {{
              t.high
                | number : (sensor.sensor_type === "ec" ? "1.0-5" : "1.0-2")
            }}
          </div>
          <div class="row-span-1 text-warning">
            {{
              t.critHigh
                | number : (sensor.sensor_type === "ec" ? "1.0-5" : "1.0-2")
            }}
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    class="grid-cols-subgrid col-span-12 lg:col-span-9 card shadow h-72 bg-base-200"
  >
    <app-line-chart
      [chartTitle]="this.getSensorTitle(sensor)"
      [sensor]="sensor"
      (sensorUpdated)="onSensorConversionDone($event)"
      class="h-full"
    ></app-line-chart>
  </div>
  }
</div>
<app-camera-picture></app-camera-picture>
<span class="text-error hidden"></span>
<span class="text-neutral hidden"></span>
